#!/usr/bin/env bash
# Run arbitrary Bash commands in a BusyBox container and log output

NAMESPACE="marrs"
IMAGE="busybox:1.36"

if [ $# -eq 0 ]; then
  echo "Usage: $0 <command>"
  exit 1
fi

CMD="$*"
TS=$(date +%F_%H-%M-%S)
LOG="$HOME/kbb_${TS}.log"

echo "[INFO] Running in namespace '$NAMESPACE': $CMD"
kubectl -n "$NAMESPACE" run kbb-test \
  --rm -i --restart=Never --image="$IMAGE" \
  --command -- sh -c "$CMD" | tee "$LOG"

echo "[INFO] Output logged to: $LOG"

