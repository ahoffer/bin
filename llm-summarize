#!/bin/bash
# Summarize text/logs/output via Ollama
# Usage: llm-summarize [file]    OR    command | llm-summarize
# Examples:
#   mvn test 2>&1 | llm-summarize
#   llm-summarize build.log
#   git diff | llm-summarize

set -euo pipefail
source "$(dirname "$0")/ollama-lib"
ollama_capture_stdin
ollama_require

# Read input
input=$(ollama_read_input 6000 "${1:-}")

system="You are a concise technical summarizer. Summarize the key points, focusing on:
- Errors, failures, warnings (most important)
- Key actions taken or changes made
- Final status/outcome
Keep it brief - bullet points preferred. Skip boilerplate and verbose output."

ollama_generate "$MODEL_CHAT" "$input" "$system"
