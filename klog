#!/usr/bin/env bash
set -euo pipefail

[[ $# -ge 1 ]] || { echo "Usage: $0 <pod-regex> [kubectl logs args...]">&2; exit 2; }
regex=$1; shift || true

mapfile -t m < <(kubectl get pods -o name | cut -d/ -f2 | grep -E "$regex" || true)
case ${#m[@]} in
  0) echo "No pods match: $regex" >&2; exit 1 ;;
  1) echo "Found ${m[0]}"; exec kubectl logs "${m[0]}" "$@" ;;
  *) echo "More than one pod matches: $regex" >&2; printf '%s\n' "${m[@]}"; exit 1 ;;
esac

