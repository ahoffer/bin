#!/bin/bash
# Summarize text/logs/output via Ollama
# Usage: llmsummarize [file]    OR    command | llmsummarize
# Examples:
#   mvn test 2>&1 | llmsummarize
#   llmsummarize build.log
#   git diff | llmsummarize

set -euo pipefail
source "$(dirname "$0")/ollamalib"
ollama_capture_stdin
ollama_require

# Read input
input=$(ollama_read_input 6000 "${1:-}")

system="You are a concise technical summarizer. Summarize the key points, focusing on:
- Errors, failures, warnings (most important)
- Key actions taken or changes made
- Final status/outcome
Keep it brief - bullet points preferred. Skip boilerplate and verbose output."

ollama_generate "$MODEL_CHAT" "$input" "$system"
