#!/usr/bin/env python3
"""Count duplicate rows in a security CSV based on package columns.

Counts duplicates by: package_names, package_versions, fixed_versions
"""

import csv
import sys

def main():
    if len(sys.argv) != 2:
        print(f"Usage: {sys.argv[0]} <csv_file>", file=sys.stderr)
        sys.exit(1)

    input_file = sys.argv[1]

    with open(input_file, 'r') as f:
        reader = csv.DictReader(f)
        rows = list(reader)

    total = len(rows)
    seen = set()
    unique_count = 0

    for row in rows:
        key = (row['package_names'], row['package_versions'], row['fixed_versions'])
        if key not in seen:
            seen.add(key)
            unique_count += 1

    dupes = total - unique_count
    print(f"Original rows: {total}")
    print(f"Unique rows: {unique_count}")
    print(f"Duplicates: {dupes}")

if __name__ == "__main__":
    main()
